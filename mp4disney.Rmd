---
title: "graph2-zazhar"
author: "Zoya Azhar"
date: "April 26, 2019"
output: html_document
---

```{r}
library(tidyverse)
library(RMySQL)
db <- dbConnect(MySQL(), 
                host = "scidb.smith.edu", 
                user = "mth292", 
                password = "RememberPi", 
                dbname = "imdb")
```

```{r}
gross_revenue <- db %>% dbGetQuery("
SELECT mi.id AS identity, info, title, production_year
FROM movie_info mi
JOIN title t
ON t.id = mi.movie_id
WHERE kind_id = 1
AND mi.info_type_id = 107 #this gives us gross revenue
AND t.title IN ('Beauty and the Beast', 'Cinderella')
AND mi.id IN (2679219,2117948,2572174, 2055452);")

```

```{r}
gross_revenue <- gross_revenue %>%
  collect()

gross_revenue <- gross_revenue %>%
  separate(info, c('gross'), sep=" ")

gross_revenue <- gross_revenue %>%
  mutate(gross_1 = gsub("\\$", "", gross)) %>%
  mutate(gross_2 = gsub("\\,", "", gross_1)) %>%
  mutate(gross_3 = as.numeric(gross_2))


graph3 <- gross_revenue %>%
  ggplot(aes(x = identity, y = gross_3)) +
  geom_col()
graph3 
```

